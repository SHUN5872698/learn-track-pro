## **1. ユーザー登録**

### **関連ファイル**

**コントローラー:**

- **app/Actions/Fortify/CreateNewUser.php**: `create` - 新規ユーザーをデータベースに登録するロジックを処理します。
- **app/Providers/FortifyServiceProvider.php**: `boot` - `CreateNewUser`アクションをLaravel Fortifyに登録しています。

**Piniaストア:**

- **resources/js/stores/auth.js**: `register` - ユーザー登録のAPI呼び出し、その後のログイン処理、エラーハンドリング、ローディング状態の管理を行います。

**コンポーネント:**

- **resources/js/views/auth/Register.vue**: ユーザー登録フォームのUIを提供し、入力値のバリデーションと登録処理のトリガーを行います。
- **resources/js/components/common/BaseButton.vue**: 登録フォームの「登録する」ボタンとして使用されます。

**バリデーション:**

- **resources/js/validators/authValidator.js**: `Register.vue`でクライアントサイドの入力値（名前、メールアドレス、パスワード）のバリデーションに使用されます。

### **1.1 正常なユーザー登録**:

- [ ]  `http://localhost:8000/register` にアクセスし、有効な名前、メールアドレス、パスワード、パスワード確認を入力して「登録する」ボタンをクリックしてください。
- [ ]  登録後、ダッシュボード (`/dashboard`) にリダイレクトされ、ログイン状態であることを確認してください。

### **1.2 バリデーションエラー**:

**名前**:

- [ ]  名前を空欄にして登録し、「名前は必須項目です。」と表示されることを確認してください。
- [ ]  名前を51文字以上にして登録し、「名前は50文字以内で入力してください」と表示されることを確認してください。

**メールアドレス**:

- [ ]  メールアドレスを空欄にして登録し、「メールアドレスは必須項目です。」と表示されることを確認してください。
- [ ]  無効なメールアドレス形式（例: `a@a`）で登録し、「メールアドレスは有効な形式で指定してください。」と表示されることを確認してください。
- [ ]  既に登録済みのメールアドレスで登録し、「指定のメールアドレスは既に使用されています。」と表示されることを確認してください。

**パスワード**:

- [ ]  パスワードを空欄にして登録し、「パスワードは必須項目です。」と表示されることを確認してください。
- [ ]  パスワードを7文字以下にして登録し、「パスワードは8文字以上で入力してください。」と表示されることを確認してください。
- [ ]  パスワードとパスワード確認が一致しない状態で登録し、「パスワードとパスワード確認が一致しません。」と表示されることを確認してください。

**パスワード表示/非表示切り替え**:

- [ ]  パスワード入力フィールドの右側にあるアイコンをクリックして、パスワードの表示/非表示が切り替わることを確認してください。

**ローディング表示**:

- [ ]  登録処理中に「登録する」ボタンがローディング状態（無効化）になることを確認してください。

**APIエラーハンドリング**:

- [ ]  API通信でエラーが発生した場合（例: ネットワーク切断、バックエンドエラーなど）、適切なエラーメッセージが表示されることを確認してください。
    - (テスト方法例: **app/Actions/Fortify/CreateNewUser.php** の `return User::create()` メソッドの直前に `abort(500, 'Internal Server Error');` を一時的に追加)

---

## **2. ログイン**

### **関連ファイル**

**コントローラー:**

- **Laravel Fortify**: ログイン処理はLaravel Fortifyが内部で管理する`/fortify/login`エンドポイントによって処理されます。直接的なアプリケーションコントローラーは存在しません。
- **app/Http/Controllers/UserController.php**: `me` - ログイン成功後、認証済みユーザーの情報を取得するために利用されます。
- **app/Providers/FortifyServiceProvider.php**: `boot` - ログイン試行のレートリミッターなどのFortify関連設定が含まれます。

**Piniaストア:**

- **resources/js/stores/auth.js**: `login` - ログインAPIの呼び出し、ユーザー情報の取得（`fetchUser`）、エラーハンドリング、ローディング状態の管理を行います。

**コンポーネント:**

- **resources/js/views/auth/Login.vue**: ログインフォームのUIを提供し、入力値のバリデーションとログイン処理のトリガーを行います。
- **resources/js/components/common/BaseButton.vue**: ログインフォームの「ログイン」ボタンとして使用されます。

**バリデーション:**

- **resources/js/validators/authValidator.js**: `Login.vue`でクライアントサイドの入力値（メールアドレス、パスワード）のバリデーションに使用されます。

### **2.1 正常なログイン**:

- [ ]  `http://localhost:8000/login` にアクセスし、登録済みのメールアドレスとパスワードを入力して「ログイン」ボタンをクリックしてください。
- [ ]  ログイン後、ダッシュボード (`/dashboard`) にリダイレクトされ、ログイン状態であることを確認してください。

### **2.2 バリデーションエラー**:

**メールアドレス**:

- [ ]  メールアドレスを空欄にしてログインし、「メールアドレスは必須項目です。」と表示されることを確認してください。
- [ ]  無効なメールアドレス形式でログインし、「メールアドレスは有効な形式で指定してください。」と表示されることを確認してください。

**パスワード**:

- [ ]  パスワードを空欄にしてログインし、「パスワードは必須項目です。」と表示されることを確認してください。

**認証失敗**:

- [ ]  登録されていないメールアドレスまたは誤ったパスワードでログインし、「認証に失敗しました。」と表示されることを確認してください。

**パスワード表示/非表示切り替え**:

- [ ]  パスワード入力フィールドの右側にあるアイコンをクリックして、パスワードの表示/非表示が切り替わることを確認してください。

**ローディング表示**:

- [ ]  ログイン処理中に「ログイン」ボタンがローディング状態（無効化）になることを確認してください。

**APIエラーハンドリング**:

- [ ]  API通信でエラーが発生した場合、適切なエラーメッセージが表示されることを確認してください。
    - Laravel Fortifyが内部的に認証処理を管理しているため、このようなAPIエラーは発生せず、テストできませんでした

---

## **3. ログアウト**

### **関連ファイル**

**コントローラー:**

- **Laravel Fortify**: ログアウト処理はLaravel Fortifyが内部で管理する`/fortify/logout`エンドポイントによって処理されます。直接的なアプリケーションコントローラーは存在しません。

**Piniaストア:**

- **resources/js/stores/auth.js**: `logout` - ログアウトAPIの呼び出し、クライアントサイドの認証状態クリア、Piniaストアのリセット、ログインページへのリダイレクトを行います。

**コンポーネント:**

- **resources/js/components/common/AppSidebar.vue**: サイドバーにログアウトボタンを提供し、クリック時にPiniaストアの`logout`アクションを呼び出します。
- **resources/js/layouts/DefaultLayout.vue**: `AppSidebar`コンポーネントを内包しており、ログアウト機能を含むアプリケーションのメインレイアウトを提供します。

### **3.1 正常なログアウト**:

- [ ]  ログイン後、ヘッダーまたはサイドバーの「ログアウト」ボタンをクリックしてください。
- [ ]  ログアウト後、ログインページ (`/login`) にリダイレクトされ、ログアウト状態であることを確認してください（ダッシュボードにアクセスできないことを確認）。

### **3.2 ローディング表示**:

- [ ]  ログアウト処理中にローディング表示が適切に行われることを確認してください。
    - 即ログアウトされるのでローディングはでない仕様

### **3.3 APIエラーハンドリング**:

- [ ]  API通信でエラーが発生した場合でも、クライアント側でログアウト状態が正しく処理され、ログインページにリダイレクトされることを確認してください。
    - Laravel Fortifyが内部的に認証処理を管理しているため、このようなAPIエラーは発生せず、テストできませんでした

---

## **4. パスワードリセット要求**

### **関連ファイル**

**コントローラー:**

- **Laravel Fortify**: パスワードリセット要求（メール送信）はLaravel Fortifyが内部で管理する`/fortify/forgot-password`エンドポイントによって処理されます。直接的なアプリケーションコントローラーは存在しません。
- **app/Actions/Fortify/ResetUserPassword.php**: このファイルはパスワードリセット要求ではなく、実際にパスワードをリセットする際に使用されるアクションです。

**Piniaストア:**

- **resources/js/stores/auth.js**: `forgotPassword` - パスワードリセットメール送信のAPI呼び出し、エラーハンドリング、ローディング状態の管理を行います。

**コンポーネント:**

- **resources/js/views/auth/PasswordReset.vue**: パスワードリセット要求フォームのUIを提供し、入力値のバリデーションとリセット要求処理のトリガーを行います。
- **resources/js/components/common/BaseButton.vue**: フォームの「リセットリンクを送信」ボタンとして使用されます。

**バリデーション:**

- **resources/js/validators/authValidator.js**: `PasswordReset.vue`でクライアントサイドの入力値（メールアドレス）のバリデーションに使用されます。

### **4.1 正常なリセット要求**:

- [ ]  `http://localhost:8000/password-reset` にアクセスし、登録済みのメールアドレスを入力して「リセットリンクを送信」ボタンをクリックしてください。
- [ ]  「パスワードリセット用のメールを送信しました。」という成功メッセージが表示されることを確認してください。
- [ ]  数秒後、ログインページに自動的にリダイレクトされることを確認してください。
- [ ]  指定したメールアドレスにパスワードリセットメールが届いていることを確認してください。

### **4.2 バリデーションエラー**:

- [ ]  メールアドレスを空欄にして送信し、「メールアドレスは必須項目です。」と表示されることを確認してください。
- [ ]  無効なメールアドレス形式で送信し、「メールアドレスは有効な形式で指定してください。」と表示されることを確認してください。
- [ ]  登録されていないメールアドレスで送信し、「このメールアドレスに一致するユーザーがいません。」と表示されることを確認してください。

### **4.3 ローディング表示**:

- [ ]  リセット要求処理中に「リセットリンクを送信」ボタンがローディング状態になることを確認してください。

### **4.4 APIエラーハンドリング**:

- [ ]  API通信でエラーが発生した場合、適切なエラーメッセージが表示されることを確認してください。
- Laravel Fortifyが内部的に認証処理を管理しているため、このようなAPIエラーは発生せず、テストできませんでした

---

## **5. パスワードリセット実行**

### **関連ファイル**

**コントローラー:**

- **app/Actions/Fortify/ResetUserPassword.php**: `reset` - ユーザーが提供したトークンと新しいパスワードを使用して、パスワードを実際に更新するロジックが含まれます。
- **app/Providers/FortifyServiceProvider.php**: `boot` - `ResetUserPassword`アクションをLaravel Fortifyに登録しています。

**Piniaストア:**

- **resources/js/stores/auth.js**: `resetPassword` - パスワードリセット実行のAPI呼び出し（`/fortify/reset-password`）、エラーハンドリング、ローディング状態の管理を行います。

**コンポーネント:**

- **resources/js/views/auth/PasswordResetConfirm.vue**: パスワードリセット実行フォームのUIを提供し、入力値のバリデーションとパスワード更新処理のトリガーを行います。
- **resources/js/components/common/BaseButton.vue**: フォームの「パスワードをリセット」ボタンとして使用されます。

**バリデーション:**

- **resources/js/validators/authValidator.js**: `PasswordResetConfirm.vue`でクライアントサイドの入力値（メールアドレス、パスワード、パスワード確認）のバリデーションに使用されます。

### **5.1 正常なパスワード再設定**:

- [ ]  パスワードリセットメール内のリンクから `http://localhost:8000/reset-password/{token}?email={email}` の形式でページにアクセスしてください（`{token}`と`{email}`はメール内のものを使用）。
- [ ]  新しいパスワードとパスワード確認を入力して「パスワードをリセット」ボタンをクリックしてください。
- [ ]  「パスワードをリセットしました。ログインページに移動します。」という成功メッセージが表示されることを確認してください。
- [ ]  数秒後、ログインページに自動的にリダイレクトされることを確認してください。
- [ ]  新しいパスワードでログインできることを確認してください。

### **5.2 バリデーションエラー**:

**メールアドレス**:

- [ ]  メールアドレスを空欄にして送信し、「メールアドレスは必須項目です。」と表示されることを確認してください。
- [ ]  無効なメールアドレス形式で送信し、「メールアドレスは有効な形式で指定してください。」と表示されることを確認してください。

**パスワード**:

- [ ]  パスワードを空欄にして送信し、「パスワードは必須項目です。」と表示されることを確認してください。
- [ ]  パスワードを7文字以下にして送信し、「パスワードは8文字以上で入力してください。」と表示されることを確認してください。
- [ ]  パスワードとパスワード確認が一致しない状態で送信し、「パスワードとパスワード確認が一致しません。」と表示されることを確認してください。

**無効なトークン**:

- [ ]  無効なトークン（例: URLのトークンを一部変更）でアクセスし、パスワードを再設定しようとすると「このパスワード再設定トークンは無効です。」と表示されることを確認してください。

**ローディング表示**:

- [ ]  パスワードリセット処理中に「パスワードをリセット」ボタンがローディング状態になることを確認してください。

**APIエラーハンドリング**:

- [ ]  API通信でエラーが発生した場合、適切なエラーメッセージが表示されることを確認してください。

---

## **6. プロフィール表示**

### **関連ファイル**

**コントローラー:**

- **app/Http/Controllers/UserController.php**: `me` - 認証済みユーザーのプロフィール情報を取得します。

**Piniaストア:**

- **resources/js/stores/auth.js**: `fetchUser` - 認証済みユーザーの情報をAPIから取得し、ストアに保存します。`authUser`ゲッターでユーザー情報を提供します。

**Composables:**

- **resources/js/composables/useUser.js**: `authStore`からユーザー情報を取得し、コンポーネントに提供します。

**コンポーネント:**

- **resources/js/views/user/Profile.vue**: ユーザーのプロフィール情報（名前、メールアドレス、アバター、登録日など）を表示します。
- **resources/js/components/common/UserAvatar.vue**: ユーザーのアバター画像またはイニシャルを表示します。
- **resources/js/layouts/DetailLayout.vue**: プロフィールページのレイアウトを提供します。

### **6.1 正常なプロフィール表示**:

- [ ]  ログイン後、サイドバーまたはヘッダーのユーザー名クリックでプロフィールページ (`/profile`) にアクセスしてください。
- [ ]  自分の名前、メールアドレス、登録日、アバター画像（設定していれば）が正しく表示されることを確認してください。

### **6.2 未認証時のアクセス**:

- [ ]  ログアウト状態でプロフィールページに直接アクセスしようとすると、ログインページにリダイレクトされることを確認してください。

### **6.3 ローディング表示**:

- [ ]  プロフィール情報取得中にローディング表示が適切に行われることを確認してください。

---

## **7. プロフィール編集**

### **関連ファイル**

**コントローラー:**

- **app/Http/Controllers/UserController.php**: `profile` - ユーザーのプロフィール情報（名前、メールアドレス）を更新します。
- **app/Http/Requests/User/ProfileRequest.php**: プロフィール更新リクエストのサーバーサイドバリデーションルールを定義します。

**Piniaストア:**

- **resources/js/stores/auth.js**: `updateProfile` - プロフィール更新APIの呼び出し、ストアのユーザー情報更新、エラーハンドリング、ローディング状態の管理を行います。

**Composables:**

- **resources/js/composables/useUser.js**: `updateUserProfile` - プロフィール更新処理を`authStore`に委譲します。

**コンポーネント:**

- **resources/js/views/user/ProfileEdit.vue**: プロフィール編集フォームのUIを提供し、入力値のバリデーションとプロフィール更新処理のトリガーを行います。
- **resources/js/components/common/UserAvatar.vue**: ユーザーのアバター画像またはイニシャルを表示します。
- **resources/js/components/common/BaseButton.vue**: フォームの「保存」ボタンとして使用されます。
- **resources/js/layouts/DetailLayout.vue**: プロフィール編集ページのレイアウトを提供します。
- **resources/js/components/common/SuccessToast.vue**: プロフィール更新成功時のトースト通知を表示します。

**バリデーション:**

- **resources/js/validators/profileValidator.js**: `ProfileEdit.vue`でクライアントサイドの入力値（名前、メールアドレス）のバリデーションに使用されます。

### 7.1 正常なプロフィール更新:

- [ ]  プロフィールページから「編集」ボタンをクリックしてプロフィール編集ページ (`/profile/edit`) にアクセスしてください。
- [ ]  現在の名前とメールアドレスがフォームに正しく表示されていることを確認してください。
- [ ]  名前またはメールアドレスを変更し、「保存」ボタンをクリックしてください。
- [ ]  「更新完了」トーストメッセージが表示され、プロフィールページにリダイレクトされ、変更が反映されていることを確認してください。

### 7.2 バリデーションエラー:

**名前:**

- [ ]  名前を空欄にして保存し、「名前は必須項目です。」と表示されることを確認してください。
- [ ]  名前を51文字以上にして保存し、「名前は50文字以内で入力してください」と表示されることを確認してください。

**7.4 メールアドレス:**

- [ ]  メールアドレスを空欄にして保存し、「メールアドレスは必須項目です。」と表示されることを確認してください。
- [ ]  無効なメールアドレス形式で保存し、「メールアドレスは有効な形式で指定してください。」と表示されることを確認してください。
- [ ]  既に登録済みのメールアドレスで保存し、「指定のメールアドレスは既に使用されています。」と表示されることを確認してください。

### 7.3 未保存の変更の確認:

- [ ]  フォームの内容を変更した後、「キャンセル」ボタンをクリックし、「編集内容が保存されていません」という確認モーダルが表示されることを確認してください。
    - このページは未実装
- [ ]  モーダルで「破棄」を選択すると、変更が破棄されプロフィールページに戻ることを確認してください。
    - このページは未実装

### 7.4 ローディング表示:

- [ ]  プロフィール更新処理中に「保存」ボタンがローディング状態になることを確認してください。

### 7.5 APIエラーハンドリング:

- [ ]  API通信でエラーが発生した場合、適切なエラーメッセージが表示されることを確認してください。

---
