## 相互リンク

[テーブル定義書](https://www.notion.so/2479d86c12e881b7b449dd88e5e6b809?pvs=21) 

.gemini/docs/databases/テーブル定義書.md

---

## 1. users テーブル

ユーザー情報を管理するテーブルです。

| データ型 | カラム名 | 属性 | 説明 |
| --- | --- | --- | --- |
| bigint | `id` | PRIMARY KEY | ユーザーID (主キー) |
| string | `name` | NOT NULL | ユーザー名 |
| string | `email` | NOT NULL, UNIQUE | メールアドレス (ユニーク) |
| timestamp | `email_verified_at` | NULLABLE | メール認証日時 |
| string | `password` | NOT NULL | パスワード (ハッシュ化済み) |
| string | `remember_token` | NULLABLE | ログイン状態維持のためのトークン |
| timestamp | `created_at` | NOT NULL | レコード作成日時 |
| timestamp | `updated_at` | NOT NULL | レコード最終更新日時 |

---

## 2. categories テーブル

技術カテゴリーを管理するテーブルです。マスターデータとして事前にSeederで投入されます（プログラミング言語、開発環境・ツール、その他）。

| データ型 | カラム名 | 属性 | 説明 |
| --- | --- | --- | --- |
| bigint | `id` | PRIMARY KEY | カテゴリーID (主キー) |
| string | `name` | NOT NULL | カテゴリー名 |
| string | `icon` | NOT NULL | カテゴリーのアイコン |
| timestamp | `created_at` | NOT NULL | レコード作成日時 |
| timestamp | `updated_at` | NOT NULL | レコード最終更新日時 |

---

## 3. technologies テーブル

学習コンテンツで利用される技術情報を管理するテーブルです。Seederで初期データを投入し、ユーザーは選択のみ可能です。

| データ型 | カラム名 | 属性 | 説明 |
| --- | --- | --- | --- |
| bigint | `id` | PRIMARY KEY | 技術ID (主キー) |
| bigint | `category_id` | FOREIGN KEY | カテゴリーID (categories.idを参照) |
| string | `name` | NOT NULL | 技術名 |
| string | `icon` | NOT NULL | 技術のアイコン |
| timestamp | `created_at` | NOT NULL | レコード作成日時 |
| timestamp | `updated_at` | NOT NULL | レコード最終更新日時 |

**外部キー制約:**

- `technologies.category_id` は `categories.id` を参照します。

---

## 4. learning_contents テーブル

学習コンテンツそのものの情報を管理するテーブルです。

| データ型 | カラム名 | 属性 | 説明 |
| --- | --- | --- | --- |
| bigint | `id` | PRIMARY KEY | 学習コンテンツID (主キー) |
| bigint | `user_id` | FOREIGN KEY | 学習コンテンツを作成したユーザーのID (users.idを参照) |
| bigint | `technology_id` | FOREIGN KEY | 使用されている技術のID (technologies.idを参照) |
| string | `title` | NOT NULL | コンテンツのタイトル |
| text | `description` | NULLABLE | コンテンツの詳細な説明 |
| int | `total_sections` | DEFAULT 0 | コンテンツの総セクション数 |
| int | `completed_sections` | DEFAULT 0 | 完了したセクション数 |
| timestamp | `created_at` | NOT NULL | レコード作成日時 |
| timestamp | `updated_at` | NOT NULL | レコード最終更新日時 |

**外部キー制約:**

- `learning_contents.user_id` は `users.id` を参照します。
- `learning_contents.technology_id` は `technologies.id` を参照します。

---

## 5. sections テーブル

学習コンテンツ内のセクション情報を管理するテーブルです。

| データ型 | カラム名 | 属性 | 説明 |
| --- | --- | --- | --- |
| bigint | `id` | PRIMARY KEY | セクションID (主キー) |
| bigint | `learning_content_id` | FOREIGN KEY | 所属する学習コンテンツのID (learning_contents.idを参照) |
| string | `title` | NOT NULL | セクションのタイトル |
| int | `order` | NOT NULL | セクションの並び順 |
| enum | `status` | DEFAULT 'not_started' | セクションのステータス ('not_started', 'in_progress', 'completed') |
| timestamp | `created_at` | NOT NULL | レコード作成日時 |
| timestamp | `updated_at` | NOT NULL | レコード最終更新日時 |

**ステータス値の説明:**

- **not_started**: 未着手（初期状態）
- **in_progress**: 学習中（学習記録が1回以上ある状態）
- **completed**: 完了（ユーザーが明示的に完了マークした状態）

**外部キー制約:**

- `sections.learning_content_id` は `learning_contents.id` を参照します。

---

## 6. learning_sessions テーブル

ユーザーの学習セッション（学習記録）を管理するテーブルです。

| データ型 | カラム名 | 属性 | 説明 |
| --- | --- | --- | --- |
| bigint | `id` | PRIMARY KEY | 学習セッションID (主キー) |
| bigint | `user_id` | FOREIGN KEY | セッションを作成したユーザーのID (users.idを参照) |
| bigint | `learning_content_id` | FOREIGN KEY | 関連する学習コンテンツのID (learning_contents.idを参照) |
| bigint | `section_id` | FOREIGN KEY | 学習したセクションのID (sections.idを参照) |
| int | `study_minutes` | NOT NULL | 学習時間（分） |
| text | `memo` | NULLABLE | セッションのメモ |
| int | `mood_rating` | NULLABLE | 調子評価（1-5段階） |
| enum | `session_type` | DEFAULT 'manual' | セッションのタイプ ('manual', 'stopwatch') |
| timestamp | `studied_at` | NOT NULL | 学習日時 |
| timestamp | `created_at` | NOT NULL | レコード作成日時 |
| timestamp | `updated_at` | NOT NULL | レコード最終更新日時 |

**セッションタイプの説明:**

- **manual**: 手動入力（時間を手入力で記録）
- **stopwatch**: ストップウォッチ（自動計測で記録）※条件付き実装

**外部キー制約:**

- `learning_sessions.user_id` は `users.id` を参照します。
- `learning_sessions.learning_content_id` は `learning_contents.id` を参照します。
- `learning_sessions.section_id` は `sections.id` を参照します。
