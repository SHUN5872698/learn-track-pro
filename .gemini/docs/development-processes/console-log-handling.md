## æ¦‚è¦

é–‹ç™ºä¸­ã«ä½¿ç”¨ã™ã‚‹`console.log`ã‚„`console.error`ã‚’æœ¬ç•ªç’°å¢ƒã‹ã‚‰è‡ªå‹•å‰Šé™¤ã™ã‚‹æ–¹é‡ã¨å®Ÿè£…æ–¹æ³•ã‚’å®šç¾©ã—ã¾ã™ã€‚

**æ¡ç”¨æ–¹é‡**: Viteã®ãƒ“ãƒ«ãƒ‰æ™‚è‡ªå‹•å‰Šé™¤ï¼ˆterserä½¿ç”¨ï¼‰

<aside>
ğŸ’¡

**æŠ€è¡“çš„èƒŒæ™¯**

- Vite 7.1.1ã§`esbuild.drop`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒæ­£ã—ãæ©Ÿèƒ½ã—ãªã„ã“ã¨ãŒåˆ¤æ˜
- ç¢ºå®Ÿã«`console.*`ã‚’å‰Šé™¤ã™ã‚‹ãŸã‚ã€**terser**ã‚’æ˜ç¤ºçš„ã«ä½¿ç”¨
- terserã®`drop_console`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æœ¬ç•ªãƒ“ãƒ«ãƒ‰æ™‚ã«å‰Šé™¤
</aside>

---

## èƒŒæ™¯ãƒ»å•é¡Œ

### ç¾åœ¨ã®çŠ¶æ³

é–‹ç™ºä¸­ã€ãƒ‡ãƒãƒƒã‚°ç”¨ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ãŒå¤§é‡ã«å‡ºåŠ›ã•ã‚Œã¦ã„ã‚‹ï¼š

```jsx
// ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã®å‡ºåŠ›ä¾‹
Pinia: fetchUser ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿: {id: 3, name: 'è—¤äº•ã€€ä¿Šç¥', avatar: null, email: '[test01@example.com](mailto:test01@example.com)', ...}
âœ… Pinia: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—æˆåŠŸ {...}
ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿åˆæœŸåŒ–å®Œäº†
API Response: {data: Array(53)}
Sessions loaded: 53
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯

**æœ¬ç•ªç’°å¢ƒã§æ®‹ã™ã¹ãã§ãªã„ãƒ­ã‚°ï¼š**

- å€‹äººæƒ…å ±ï¼ˆåå‰ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰
- èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆerror.config.headersã«å«ã¾ã‚Œã‚‹å¯èƒ½æ€§ï¼‰
- å†…éƒ¨å®Ÿè£…ã®è©³ç´°

**æ®‹ã—ã¦ã‚‚OKãªãƒ­ã‚°ï¼š**

- æ±ç”¨çš„ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- çŠ¶æ…‹ç¢ºèªç”¨ã®ç°¡æ½”ãªãƒ­ã‚°

### å‰Šé™¤ã•ã‚Œã‚‹ç¯„å›²ã®æ˜ç¢ºåŒ–

**å‰Šé™¤ã•ã‚Œã‚‹ã‚‚ã®ï¼š**

- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰å†…ã®`console.*`ã®ã¿
- ä¾‹ï¼š`console.log()`, `console.error()`, `console.warn()`, [`console.info](http://console.info)()`, `console.debug()`

**å‰Šé™¤ã•ã‚Œãªã„ã‚‚ã®ï¼ˆæœ¬ç•ªç’°å¢ƒã§ã‚‚è¡¨ç¤ºã•ã‚Œã‚‹ï¼‰ï¼š**

- ãƒ–ãƒ©ã‚¦ã‚¶è‡ªèº«ãŒå‡ºåŠ›ã™ã‚‹ãƒ­ã‚°ãƒ»ã‚¨ãƒ©ãƒ¼
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ï¼ˆä¾‹ï¼š`GET /api/users 500 (Internal Server Error)`ï¼‰
- JavaScriptã‚¨ãƒ©ãƒ¼ï¼ˆä¾‹ï¼š`Uncaught TypeError: ...`ï¼‰
- Vueè­¦å‘Šï¼ˆä¾‹ï¼š`[Vue warn]: ...`ï¼‰

ã¤ã¾ã‚Šã€é–‹ç™ºã«å¿…è¦ãªæƒ…å ±ï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ç­‰ï¼‰ã¯æœ¬ç•ªã§ã‚‚ç¢ºèªã§ãã‚‹ãŒã€å€‹äººæƒ…å ±ã‚’å«ã‚€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã¯å‰Šé™¤ã•ã‚Œã‚‹ã€‚

---

## æ¡ç”¨ã—ãŸè§£æ±ºç­–

### Viteã®ãƒ“ãƒ«ãƒ‰æ™‚è‡ªå‹•å‰Šé™¤ï¼ˆterserä½¿ç”¨ï¼‰

`vite.config.js`ã§**terser**ã‚’ä½¿ç”¨ã—ã€æœ¬ç•ªãƒ“ãƒ«ãƒ‰æ™‚ã«è‡ªå‹•å‰Šé™¤ã™ã‚‹æ–¹å¼ã‚’æ¡ç”¨ã€‚

### é¸å®šç†ç”±

| é …ç›® | ç’°å¢ƒå¤‰æ•°åˆ¶å¾¡ | Viteãƒ“ãƒ«ãƒ‰æ™‚å‰Šé™¤ï¼ˆæ¡ç”¨ï¼‰ |
| --- | --- | --- |
| å·¥æ•° | é«˜ã„
- logger.jsä½œæˆ
- å…¨ãƒ•ã‚¡ã‚¤ãƒ«ä¿®æ­£
- æ¤œè¨¼å¿…é ˆ | æœ€å°
- terserã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- vite.config.jsä¿®æ­£ã®ã¿
- æ—¢å­˜ã‚³ãƒ¼ãƒ‰å¤‰æ›´ä¸è¦ |
| é–‹ç™ºä½“é¨“ | æ™®é€š
- loggerçµŒç”±ã§è¨˜è¿° | æœ€é«˜
- é–‹ç™ºä¸­ã¯`console.*`ã‚’è‡ªç”±ã«ä½¿ãˆã‚‹
- æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã§è‡ªå‹•å‰Šé™¤ |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | å®‰å…¨
- æœ¬ç•ªã§ç„¡åŠ¹åŒ– | å®‰å…¨
- æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã§å®Œå…¨å‰Šé™¤ |
| ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ | ä¸­
- loggerç®¡ç†ãŒå¿…è¦ | ä¸è¦
- è‡ªå‹•å‡¦ç† |
| ãƒ‡ãƒ—ãƒ­ã‚¤å„ªå…ˆ | å·¥æ•°å¢— | Phase 3ã¸å½±éŸ¿ãªã— |

---

## å®Ÿè£…æ–¹æ³•

### 1. terserã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# Dockerã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œ
npm install --save-dev terser
```

### 2. vite.config.jsã®ä¿®æ­£

```jsx
import { defineConfig } from 'vite';
import laravel from 'laravel-vite-plugin';
import vue from '@vitejs/plugin-vue';
import path from 'path';

export default defineConfig({
  server: {
    host: '0.0.0.0',
    port: 5173,
    strictPort: true,
  },
  plugins: [
    vue(),
    laravel({
      input: ['resources/css/app.css', 'resources/js/app.js'],
      refresh: true,
    }),
  ],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './resources/js'),
    },
  },
  // æœ¬ç•ªãƒ“ãƒ«ãƒ‰æ™‚ã®è¨­å®š
  build: {
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true,
      },
    },
  },
});
```

### 3. æ—¢å­˜ã®console.logã¯ä¿®æ­£ä¸è¦

```jsx
// stores/auth.js - ãã®ã¾ã¾æ®‹ã™
console.log('âœ… Pinia: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—æˆåŠŸ', [response.data](http://response.data));
```

<aside>
ğŸ“Œ

**ç†ç”±**

- é–‹ç™ºä¸­ï¼ˆ`npm run dev`ï¼‰ã¯ä¾¿åˆ©ã«ä½¿ãˆã‚‹
- æœ¬ç•ªãƒ“ãƒ«ãƒ‰ï¼ˆ`npm run build`ï¼‰æ™‚ã«è‡ªå‹•å‰Šé™¤ã•ã‚Œã‚‹
- ãƒ•ã‚¡ã‚¤ãƒ«ä¿®æ­£ãŒä¸è¦ã§å·¥æ•°æœ€å°
</aside>

---

## å‹•ä½œç¢ºèª

### é–‹ç™ºç’°å¢ƒï¼ˆä»Šã¾ã§é€šã‚Šï¼‰

```bash
# Dockerç’°å¢ƒã§é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
docker compose exec php-apache bash -c "cd /var/www/html && npm run dev"
# â†’ console.logãŒè¡¨ç¤ºã•ã‚Œã‚‹
```

### æœ¬ç•ªãƒ“ãƒ«ãƒ‰ï¼ˆPhase 3ã§ç¢ºèªï¼‰

```bash
# æœ¬ç•ªãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ
docker compose exec php-apache bash -c "cd /var/www/html && npm run build"

# ç¢ºèªæ–¹æ³•
grep -r "console.log" public/build/assets/
# â†’ ä½•ã‚‚è¦‹ã¤ã‹ã‚‰ãªã‘ã‚Œã°OK
```

**ç¢ºèªã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼š**

- ç¾åœ¨ï¼ˆPhase 2ï¼‰ï¼šä½•ã‚‚ã—ãªãã¦OK
- Phase 3ãƒ‡ãƒ—ãƒ­ã‚¤ç›´å‰ï¼š`npm run build`ã§ç¢ºèªï¼ˆæ‰€è¦æ™‚é–“ï¼š5åˆ†ï¼‰

---

## ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ã¨ã®é–¢ä¿‚

ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ã«ä¾å­˜ã›ãšã€ã©ã®ç’°å¢ƒã§ã‚‚åŒæ§˜ã«å‹•ä½œã™ã‚‹ã€‚

| ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³• | ãƒ“ãƒ«ãƒ‰å‡¦ç† | å½±éŸ¿ |
| --- | --- | --- |
| Dockerï¼ˆæœ¬ç•ªæœ€é©åŒ–ï¼‰ | CI/CDã¾ãŸã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§
`npm run build` | åŒã˜ |
| VPSï¼ˆç›´æ¥ãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰ | CI/CDã¾ãŸã¯VPSä¸Šã§
`npm run build` | åŒã˜ |
| AWS/Azureï¼ˆãƒãƒãƒ¼ã‚¸ãƒ‰ï¼‰ | CI/CDã§
`npm run build` | åŒã˜ |

<aside>
ğŸ’¡

**è£œè¶³**

- ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ã®æ¤œè¨ã¯ç‹¬ç«‹ã—ã¦é€²ã‚ã‚‰ã‚Œã‚‹
- terserã®è¨­å®šã¯ã©ã®ç’°å¢ƒã§ã‚‚æœ‰åŠ¹
- ãƒ“ãƒ«ãƒ‰æ™‚é–“ã¯esbuildã‚ˆã‚Šè‹¥å¹²é•·ã„ï¼ˆæ•°ç§’ç¨‹åº¦ï¼‰
- Phase 3ã§è‡ªç”±ã«ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ã‚’é¸æŠã§ãã‚‹
</aside>

---

## ä»Šå¾Œã®æ‹¡å¼µï¼ˆPhase 4ä»¥é™ï¼‰

### ç’°å¢ƒã”ã¨ã®ç´°ã‹ã„åˆ¶å¾¡ãŒå¿…è¦ã«ãªã£ãŸå ´åˆ

**vite-plugin-remove-console ãƒ—ãƒ©ã‚°ã‚¤ãƒ³**

```jsx
// vite.config.js
import removeConsole from 'vite-plugin-remove-console';
export default defineConfig({
  plugins: [
    vue(),
    laravel({...}),
    removeConsole(),  // æœ¬ç•ªãƒ“ãƒ«ãƒ‰æ™‚ã®ã¿è‡ªå‹•é©ç”¨
  ],
});
```

```bash
npm install vite-plugin-remove-console --save-dev
```

<aside>
âœ…

**ãƒ¡ãƒªãƒƒãƒˆ**

- ç’°å¢ƒã”ã¨ã®ç´°ã‹ã„åˆ¶å¾¡ãŒå¯èƒ½
- console.errorã®ã¿æ®‹ã™ãªã©ã®è¨­å®šã‚‚ç°¡å˜
</aside>

<aside>
ğŸ“Œ

**terserã¨ã®æ¯”è¼ƒ**

- terser: æ¥­ç•Œæ¨™æº–ã€ç¢ºå®Ÿæ€§ãŒé«˜ã„ã€ç´°ã‹ã„åˆ¶å¾¡ã‚‚å¯èƒ½
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³: è¨­å®šãŒç°¡å˜ã ãŒã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹çŠ¶æ³ã«ä¾å­˜
- ç¾æ™‚ç‚¹ã§ã¯terserã§ååˆ†
</aside>

### ç’°å¢ƒå¤‰æ•°åˆ¶å¾¡ãŒå¿…è¦ã«ãªã‚‹ã‚±ãƒ¼ã‚¹

ä»¥ä¸‹ã®å ´åˆã¯ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹åˆ¶å¾¡ã‚’æ¤œè¨ï¼š

1. **æœ¬ç•ªç’°å¢ƒã§ã‚‚ãƒ­ã‚°ã‚’ä¸€æ™‚çš„ã«æœ‰åŠ¹åŒ–ã—ãŸã„**
    - ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚
    - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹èª¿æŸ»æ™‚
2. **ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ï¼ˆdebug, info, warn, errorï¼‰ã‚’ç´°ã‹ãåˆ¶å¾¡ã—ãŸã„**
    - é–‹ç™ºï¼šå…¨ã¦è¡¨ç¤º
    - ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ï¼šwarnä»¥ä¸Š
    - æœ¬ç•ªï¼šerrorã®ã¿
3. **ç›£è¦–ãƒ„ãƒ¼ãƒ«ï¼ˆSentryç­‰ï¼‰ã¨é€£æºã—ãŸã„**
    - ã‚¨ãƒ©ãƒ¼ã‚’å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã«é€ä¿¡
    - ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡Œå‹•ã®ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°

### å®Ÿè£…ä¾‹ï¼ˆå‚è€ƒï¼‰

```jsx
// utils/logger.jsï¼ˆPhase 4ä»¥é™ã§æ¤œè¨ï¼‰
const isDev = [import.meta.env.DEV](http://import.meta.env.DEV);
const isDebugEnabled = import.meta.env.VITE_ENABLE_CONSOLE_LOG === 'true';

export const logger = {
  debug: (...args) => {
    if (isDev || isDebugEnabled) console.log(...args);
  },
  info: (...args) => {
    if (isDev || isDebugEnabled) [console.info](http://console.info)(...args);
  },
  warn: (...args) => console.warn(...args),
  error: (...args) => console.error(...args),
};
```

**ç¾æ™‚ç‚¹ã®åˆ¤æ–­ï¼š**

- Phase 2ãƒ»Phase 3ã§ã¯å°å…¥ã—ãªã„ï¼ˆå·¥æ•°å‰Šæ¸›å„ªå…ˆï¼‰
- Phase 4ä»¥é™ã§å¿…è¦ã«å¿œã˜ã¦æ¤œè¨

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### console.logãŒå‰Šé™¤ã•ã‚Œãªã„å ´åˆ

**ç¢ºèªæ‰‹é †ï¼š**

```bash
# 1. ãƒ“ãƒ«ãƒ‰ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å®Œå…¨å‰Šé™¤
rm -rf public/build

# 2. å†ãƒ“ãƒ«ãƒ‰
npm run build

# 3. ç¢ºèª
grep -r "console.log" public/build/assets/
```

**ãã‚Œã§ã‚‚å‰Šé™¤ã•ã‚Œãªã„å ´åˆï¼š**

1. terserãŒæ­£ã—ãã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

```bash
npm list terser
```

1. vite.config.jsã®å†…å®¹ã‚’ç¢ºèª

```bash
cat vite.config.js | grep -A 10 "build:"
```

1. package-lock.jsonã‚’å‰Šé™¤ã—ã¦å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
rm package-lock.json
npm install
npm run build
```

### ãƒ“ãƒ«ãƒ‰æ™‚é–“ãŒé•·ã„

**åŸå› ï¼š**

- terserã¯esbuildã‚ˆã‚Šåœ§ç¸®å‡¦ç†ãŒé…ã„

**å¯¾ç­–ï¼š**

- é–‹ç™ºä¸­ã¯`npm run dev`ã‚’ä½¿ç”¨ï¼ˆterserã¯å®Ÿè¡Œã•ã‚Œãªã„ï¼‰
- æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã®ã¿terserãŒå‹•ä½œã™ã‚‹ãŸã‚ã€é–‹ç™ºä½“é¨“ã«å½±éŸ¿ãªã—
- æ•°ç§’ç¨‹åº¦ã®é•ã„ãªã®ã§ã€è¨±å®¹ç¯„å›²

---

## ã¾ã¨ã‚

### æ¡ç”¨æ–¹é‡

Viteã®ãƒ“ãƒ«ãƒ‰æ™‚è‡ªå‹•å‰Šé™¤ï¼ˆterserä½¿ç”¨ï¼‰ã‚’æ¡ç”¨

### ãƒ¡ãƒªãƒƒãƒˆ

1. å·¥æ•°æœ€å°ï¼ˆterserã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« + vite.config.jsä¿®æ­£ã®ã¿ï¼‰
2. æ¤œè¨¼ä¸è¦ï¼ˆæ—¢å­˜æ©Ÿèƒ½ã«å½±éŸ¿ãªã—ï¼‰
3. é–‹ç™ºåŠ¹ç‡ç¶­æŒï¼ˆconsole.logè‡ªç”±ã«ä½¿ãˆã‚‹ï¼‰
4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¢ºä¿ï¼ˆæœ¬ç•ªã§ã¯å®Œå…¨å‰Šé™¤ï¼‰
5. ãƒ‡ãƒ—ãƒ­ã‚¤å„ªå…ˆï¼ˆPhase 3ã¸ã®å½±éŸ¿ãªã—ï¼‰
6. ç¢ºå®Ÿæ€§ï¼ˆæ¥­ç•Œæ¨™æº–ã®terserã‚’ä½¿ç”¨ï¼‰

### å®Ÿè£…çŠ¶æ³

- terserã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†
- vite.config.jsä¿®æ­£å®Œäº†ï¼ˆterserä½¿ç”¨ï¼‰
- æ—¢å­˜ã‚³ãƒ¼ãƒ‰å¤‰æ›´ä¸è¦
- ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§å‹•ä½œæ¤œè¨¼æ¸ˆã¿

---

## å‚è€ƒè³‡æ–™

### é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- æ©Ÿèƒ½æ‹¡å¼µãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—
  - [feature-expansion-roadmap.md](../project-infos/feature-expansion-roadmap.md)
  - [Notion](https://www.notion.so/2499d86c12e880b9ba25d1cc7e8d71f3?pvs=21)

### Viteå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Building for Production - Vite](https://vitejs.dev/guide/build.html)
- [Terser Options](https://terser.org/docs/api-reference#compress-options)

---
